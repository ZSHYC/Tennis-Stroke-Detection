### `3_trajectory_labeler.py` 使用指南

#### **1. 工具概述**
这是一个专为网球项目开发的 **轨迹级交互式标注工具**。
它的作用是：让你在静态背景图上，通过观看球的飞行轨迹动画，手动标记出 **击球发生的瞬间 (Hit Frame)**。

相比于传统的看视频标注，它的优势在于：
1.  **无需视频文件**：直接读取 Log 里的坐标即可复现比赛过程。
2.  **视觉直观**：球的轨迹以“拖尾”形式呈现，击球时的折射（V字形）一目了然。
3.  **多击球点支持**：允许在同一段轨迹中标记多个击球点（例如多回合对打）。

---

#### **2. 启动前准备**
请确保以下文件存在：
1.  `output/training_segment.csv` (由 `2_prepare_data.py` 生成)
2.  `left.jpg` (球场背景图)

#### **3. 核心配置**
```python
# 起始位置控制
FORCE_START_INDEX = -1 
# -1 : 自动从上次没标完的地方开始（推荐）
# 0  : 强制从头开始（用于复查）
# 100: 跳到第100条轨迹
```

#### **4. 操作手册 (Cheatsheet)**

| 按键 | 功能 | 场景 |
| :--- | :--- | :--- |
| **Space (空格)** | 暂停 / 继续播放 | 看到球突然变向时，按空格停住。 |
| **`,` (逗号)** | 上一帧 | 暂停时微调，往回找击球点。 |
| **`.` (句号)** | 下一帧 | 暂停时微调，往后找击球点。 |
| **`1`** | **添加/移除标记** | 在当前帧打上“击球”标记（黄圈）。再次按则取消。 |
| **`0`** | **清空标记** | 清除当前轨迹的所有标记。 |
| **`Enter`** | **确认并下一条** | 保存当前标记，自动跳转到下一条轨迹。 |
| **`D`** | 同 Enter | 方便左手操作。 |
| **`A`** | **返回上一条** | 返回上一条轨迹进行修改。 |
| **`Q`** | **保存并退出** | 退出程序并保存进度。 |

#### **5. 界面解读**
*   **绿点**：正在飞行的球。
*   **灰点**：历史轨迹。
*   **黄圈 + HIT**：你标记的击球点。
*   **[HAS HIT] / [NO HIT]**：顶部状态栏显示当前轨迹是否已包含击球标记。

#### **6. 注意事项**
*   **保存机制**：程序每处理 5 条数据会自动保存一次 CSV。按 Q 退出时也会强制保存。
*   **数据格式**：标记结果会保存在 `hit_frames_global` 列，格式为字符串（如 `"12345,12350"`），兼容多点标记。

